<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:xamarinapp="clr-namespace:XamarinApp"
             x:Class="XamarinApp.StatusPage"
             Title="Status">
  <ContentPage.Content>
    <FlexLayout Direction="Column" JustifyContent="End" x:Name="FlexMain" BackgroundColor="DarkGray">
      <FlexLayout.Resources>
        <Style TargetType="Label">
          <Setter Property="VerticalOptions" Value="Center"/>
          <Setter Property="TextColor" Value="White"/>
          <Setter Property="FontSize">
            <OnPlatform WPF="15"/>
          </Setter>
        </Style>
      </FlexLayout.Resources>
      <Grid FlexLayout.Grow="4" Padding="5" BackgroundColor="DarkRed">
        <Grid.RowDefinitions>
          <RowDefinition Height="*"/>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="Auto"/>
          <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid Grid.Row="0" VerticalOptions="FillAndExpand" BackgroundColor="DimGray">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="Auto" />
          </Grid.ColumnDefinitions>
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
          </Grid.RowDefinitions>
          <!--https://icon-icons.com/de-->
          <Image Grid.Row="0" Grid.Column="0" Grid.RowSpan="1" Source="Weather_01.png" Aspect="AspectFill" WidthRequest="64" HorizontalOptions="Start" VerticalOptions="Start"/>
          <Label Grid.Row="0" Grid.Column="1" Text="{Binding Mower.Name}" HorizontalOptions="Center" TextColor="Yellow" FontSize="Title" />
          <StackLayout Grid.Row="0" Grid.Column="2" Grid.RowSpan="2" Grid.ColumnSpan="2">
            <Image x:Name="ImageWifi" Source="Wifi_Gray.png" HeightRequest="32" />
            <Label Text="{Binding Mower.Rrsi}" HorizontalOptions="Center"/>
          </StackLayout>
            
          <Image Grid.Row="1" Grid.Column="0" Grid.RowSpan="3" Grid.ColumnSpan="2" Source="Mower.png" Aspect="AspectFit" VerticalOptions="End"/>
            
          <Label Grid.Row="2" Grid.Column="2" Text="SP" />
          <Label Grid.Row="2" Grid.Column="3" Text="{Binding Mower.Startpoint, FallbackValue=0}" />
          <Label Grid.Row="3" Grid.Column="2" Text="FW" />
          <Label Grid.Row="3" Grid.Column="3" Text="{Binding Mower.Firmware, FallbackValue=0.12}" />
        </Grid>

        <StackLayout Grid.Row="1" Orientation="Horizontal" HorizontalOptions="Center">
          <Label Text="{Binding Mower.State, FallbackValue=State}" HorizontalTextAlignment="End"/>
          <Label Text="{Binding Mower.Error, FallbackValue=Error}" HorizontalTextAlignment="Start"/>
        </StackLayout>

        <AbsoluteLayout Grid.Row="2">
          <Image AbsoluteLayout.LayoutBounds="0,0,1,1" AbsoluteLayout.LayoutFlags="All" Source="Accu_Back.png" Aspect="Fill" />
          <Label AbsoluteLayout.LayoutBounds=".5,.5,-1,-1" AbsoluteLayout.LayoutFlags="PositionProportional" TextColor="Black">
            <Label.FormattedText>
              <FormattedString>
                <Span Text="Akkumulator:"/>
                <Span Text='{Binding Mower.Accu.Volt, StringFormat=" {0}V"}'  />
                <Span Text="{Binding Mower.Accu.Temp, StringFormat=' {0}°'}" />
              </FormattedString>
            </Label.FormattedText>
          </Label>
        </AbsoluteLayout>

        <Grid Grid.Row="3">
          <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
          </Grid.ColumnDefinitions>
          <Image Grid.Column="0" Grid.ColumnSpan="3" Source="Work_Back.png" Aspect="Fill" />
          <Label Grid.Column="1" VerticalOptions="Center" TextColor="Black">
            <Label.FormattedText>
              <FormattedString>
                <Span Text="Arbeitszeit: "/>
                <Span Text='{Binding Mower.Start, StringFormat=" {0}"}' />
                <Span Text="{Binding Mower.Duration, StringFormat=' {0}'}" />
              </FormattedString>
            </Label.FormattedText>
          </Label>
        </Grid>
      </Grid>

      <FlexLayout x:Name="FlexBack" FlexLayout.Grow="2" Direction="Column" JustifyContent="SpaceBetween" AlignItems="Stretch" BackgroundColor="DarkViolet">
        <StackLayout x:Name="StackOrient" Orientation="Horizontal" Margin="10,0,10,0" Spacing="5" BackgroundColor="DarkBlue">
          <StackLayout x:Name="StackPitch" Orientation="Vertical" HorizontalOptions="CenterAndExpand" Padding="0">
            <Image x:Name="ImgPitch" Source="Orient_Pitch.png" Aspect="AspectFit" HorizontalOptions="Center"/>
            <Label Text='{Binding Mower.Pitch, StringFormat="Steigung: {0}°"}' HorizontalOptions="Center"/>
          </StackLayout>
          <StackLayout x:Name="StackRoll" Orientation="Vertical" HorizontalOptions="CenterAndExpand" Padding="0">
            <Image x:Name="ImgRoll" Source="Orient_Roll.png" Aspect="AspectFit" HorizontalOptions="Center"/>
            <Label Text='{Binding Mower.Roll, StringFormat="Neigung: {0}°"}' HorizontalOptions="Center"/>
          </StackLayout>
          <StackLayout x:Name="StackYaw" Orientation="Vertical" HorizontalOptions="CenterAndExpand" Padding="0">
            <Image x:Name="ImgYaw" Source="Orient_Yaw.png" Aspect="AspectFit" HorizontalOptions="Center"/>
            <Label Text='{Binding Mower.Yaw, StringFormat="Richtung: {0}°"}' HorizontalOptions="Center"/>
          </StackLayout>
        </StackLayout>

        <StackLayout x:Name="StackStat" Orientation="Horizontal" Margin="10,0,10,0" Spacing="5" BackgroundColor="DarkGreen">
          <StackLayout Orientation="Horizontal" HorizontalOptions="CenterAndExpand" Padding="0">
            <Label Text="T-Mäh:" HorizontalOptions="StartAndExpand"/>
            <Label Text='{Binding Mower.BladeTime, StringFormat="{0}", FallbackValue="0.00:00:00"}'/>
          </StackLayout>
          <StackLayout Orientation="Horizontal" HorizontalOptions="CenterAndExpand" Padding="0">
            <Label Text="S-Ges:"  HorizontalOptions="StartAndExpand"/>
            <Label Text='{Binding Mower.Distance, StringFormat="{0:n0}m", FallbackValue=1000000}'/>
          </StackLayout>
          <StackLayout Orientation="Horizontal" HorizontalOptions="CenterAndExpand" Padding="0">
            <Label Text="T-Ges:" HorizontalOptions="StartAndExpand"/>
            <Label Text='{Binding Mower.WorkTime, StringFormat="{0}", FallbackValue="0.00:00:00"}'/>
          </StackLayout>
        </StackLayout>

        <Label FlexLayout.AlignSelf="Center" BackgroundColor="DarkKhaki">
          <Label.Font>
            <OnPlatform x:TypeArguments="Font">
              <On Platform="Android" Value="Normal, Italic"/>
              <On Platform="WPF" Value="Normal, Italic, Micro"/>
            </OnPlatform>
          </Label.Font>
          <Label.FormattedText>
            <FormattedString>
              <Span Text="{Binding Label.Stamp, FallbackValue='Stand:'}"/>
              <Span Text=" "/>
              <Span Text="{Binding Mower.Stamp, FallbackValue='19:9:19 19.9.19'}"/>
            </FormattedString>
          </Label.FormattedText>
        </Label>

        <StackLayout FlexLayout.AlignSelf="Center" Orientation="Horizontal" BackgroundColor="DimGray">
          <ImageButton Command="{Binding PollCommand}" Source="Button_Home.png" BackgroundColor="Transparent" />
          <ImageButton Command="{Binding PollCommand}" Source="Button_Play.png" BackgroundColor="Transparent" />
          <ImageButton Command="{Binding PollCommand}" Source="Button_Pause.png" BackgroundColor="Transparent" />
          <BoxView WidthRequest="20" />
          <ImageButton Command="{Binding PollCommand}" Source="Button_Poll.png" BackgroundColor="Transparent" />
        </StackLayout>

      </FlexLayout>
    </FlexLayout>

  </ContentPage.Content>
</ContentPage>